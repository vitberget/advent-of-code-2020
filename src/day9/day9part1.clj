(ns day9.day9part1
  (:require [ysera.test :refer [is is= is-not]]
            [clojure.string :as str]))


(defn list-has-to-summing-to
  {:test (fn []
           (is (list-has-to-summing-to
                 (list 40 62 55 65 95)
                 102))
           (is-not (list-has-to-summing-to
                     (list 95 102 117 150 182)
                     127)))}
  [list desired-sum]
  (loop [[num & rest] list]
    (cond
      (nil? rest)
      false

      (->> rest
           (filter (fn [n]
                     (= (+ num n) desired-sum)))
           (not-empty))
      true

      :else
      (recur rest))))

(defn day9part1
  {:test (fn []
           (is= (day9part1
                  "35\n20\n15\n25\n47\n40\n62\n55\n65\n95\n102\n117\n150\n182\n127\n219\n299\n277\n309\n576"
                  5)
                127))}
  [string pre-amble]
  (let [numbers (->> string
                     (str/split-lines)
                     (map read-string))]
    (loop [five (take pre-amble numbers)
           [num & rest-of-numbers] (drop pre-amble numbers)]
      (if (not (list-has-to-summing-to five num))
        num
        (recur (-> five
                   (rest)
                   (concat (list num)))
               rest-of-numbers)))))


(comment
  (def my-puzzle "48\n1\n4\n32\n17\n19\n35\n6\n8\n49\n29\n33\n50\n5\n38\n41\n36\n28\n23\n31\n44\n20\n45\n21\n9\n10\n7\n11\n39\n15\n17\n40\n47\n12\n14\n16\n64\n26\n19\n27\n71\n18\n111\n22\n23\n24\n25\n125\n20\n62\n58\n54\n28\n29\n30\n173\n31\n32\n45\n55\n51\n42\n38\n74\n44\n43\n40\n49\n47\n48\n57\n65\n50\n52\n105\n82\n58\n68\n61\n84\n101\n116\n70\n125\n78\n81\n199\n83\n100\n87\n88\n170\n169\n108\n140\n107\n193\n139\n168\n229\n161\n119\n178\n131\n157\n248\n148\n188\n165\n159\n181\n171\n175\n187\n294\n196\n267\n226\n300\n238\n246\n309\n250\n279\n403\n288\n306\n290\n296\n305\n307\n313\n324\n330\n493\n682\n346\n362\n383\n422\n434\n464\n551\n484\n553\n601\n529\n538\n578\n1004\n1311\n643\n707\n603\n612\n747\n735\n654\n846\n708\n796\n768\n847\n805\n856\n898\n948\n1013\n1062\n1207\n2158\n1325\n1380\n1552\n1602\n1503\n1745\n1215\n1257\n1510\n1642\n1582\n2835\n1794\n1476\n1564\n2538\n2438\n1661\n1754\n2328\n2228\n2075\n2464\n2422\n2907\n2472\n2595\n2691\n2817\n2718\n2725\n2839\n3303\n3318\n5045\n3040\n4002\n5782\n9085\n4960\n3415\n3829\n3736\n3982\n4403\n4766\n11803\n4886\n5746\n5067\n5163\n7777\n6461\n9161\n6547\n6043\n5879\n6343\n6358\n6455\n6776\n7151\n7244\n7397\n9049\n7565\n8803\n7718\n8385\n9169\n10645\n13791\n11522\n10230\n15808\n11939\n11922\n12222\n12813\n22567\n13606\n17474\n12701\n19033\n17434\n13927\n16320\n22452\n14962\n19030\n41600\n25859\n22169\n22152\n25489\n20875\n21752\n24735\n22931\n24623\n41199\n30175\n25514\n26307\n26628\n27663\n35350\n28889\n31282\n35679\n30247\n33992\n35837\n57519\n61209\n47658\n42627\n43027\n47666\n48420\n45610\n44683\n47554\n65854\n50137\n66012\n51821\n64726\n69671\n54291\n56552\n59136\n91047\n61529\n110537\n88283\n96086\n78464\n142574\n85654\n87310\n87710\n110336\n90293\n187133\n92237\n94820\n97691\n116547\n178576\n106112\n108373\n131200\n110843\n162664\n205357\n120665\n148839\n177603\n273507\n164118\n422346\n168757\n182130\n288912\n193822\n185113\n356486\n182530\n187057\n205663\n208534\n387793\n216955\n259682\n305778\n219216\n339881\n274961\n269504\n409577\n326328\n312957\n332875\n351287\n471042\n350887\n353870\n457091\n367643\n369587\n427750\n388193\n422618\n578121\n723457\n425489\n529912\n436171\n478898\n757780\n628793\n737230\n544465\n595832\n645832\n639285\n663844\n683762\n935989\n781620\n704757\n918105\n755836\n790261\n792205\n813682\n1032003\n848107\n1089333\n1267922\n1881538\n915069\n980636\n1023363\n1420992\n1140297\n1569518\n1786129\n1235117\n1563937\n1419680\n1347606\n1388519\n1460593\n2213197\n1640312\n1546097\n1736472\n1903015\n1661789\n1763176\n1828743\n3521850\n1895705\n2291285\n2809492\n3184168\n2003999\n2258480\n3043312\n2654797\n3030111\n3874986\n2582723\n3724448\n3673790\n3374840\n3971242\n3197065\n5638162\n4154185\n3207886\n5703729\n5079873\n4872055\n4549765\n4550502\n3899704\n4186990\n4262479\n5779788\n5862683\n7986927\n6929815\n7001353\n5790609\n5612834\n7346082\n6307171\n10188664\n7757651\n6404951\n7096769\n8069120\n7107590\n10125162\n7758388\n8086694\n8162183\n8449469\n8450206\n8737492\n9512538\n9799824\n11403443\n11392622\n11475517\n11920005\n15451559\n12195560\n14528101\n12709603\n12712122\n17782688\n14567134\n19151010\n14474071\n14204359\n22614795\n14865978\n16612389\n15845082\n16248877\n16611652\n16899675\n17187698\n20915981\n19312362\n24113046\n23671077\n22868139\n25679876\n24629608\n25421725\n24905163\n26913962\n28554685\n26916481\n35763399\n43780618\n29340049\n49350953\n33224041\n30711060\n39771141\n32093959\n26796446\n40055837\n67857358\n34087373\n40228343\n43425408\n43941970\n46539216\n48289864\n49534771\n50051333\n58716981\n59265745\n74956496\n70766897\n56256530\n93476741\n56136495\n58890405\n129657302\n62805019\n60020487\n79999484\n60883819\n73335662\n66852283\n74143210\n92977778\n89763114\n94829080\n119874878\n90481186\n96073987\n97824635\n112339790\n118156150\n149613236\n127736102\n115026900\n117020314\n174828564\n119774224\n116156982\n118910892\n153335146\n120904306\n175047387\n183872597\n237067042\n140187945\n191163524\n189170110\n180244300\n184592194\n202820976\n206638168\n186555173\n193898622\n235067874\n227366690\n238685116\n329857536\n232047214\n434868190\n235931206\n428966496\n377868363\n256344927\n376119151\n366210911\n412291514\n320432245\n324060542\n561904750\n324780139\n383068732\n463297896\n364836494\n391230362\n380453795\n523756158\n559848013\n421265312\n462434564\n600767700\n467978420\n556363451\n856133502\n576777172\n492276133\n580405469\n581125066\n622555838\n644492787\n648840681\n1054180883\n645212384\n704514337\n792758559\n689616633\n745290289\n756066856\n1315914869\n771684157\n801719107\n883699876\n1052124146\n889243732\n954710697\n1157131151\n960254553\n1690962839\n1069053305\n1441599240\n1582810391\n1226337450\n1337191922\n1389783076\n1450559788\n1294053065\n1334829017\n1849498285\n1394130970\n1644327330\n1434906922\n2339803520\n2621182442\n1573403264\n3958374364\n1685418983\n2640129680\n1843954429\n3143551350\n2181048147\n2226184456\n2616120526\n2295390755\n2363106370\n3529373412\n4847366898\n3745950543\n2628882082\n2824689998\n3023963052\n2688184035\n2728959987\n5269011762\n4265509772\n4991988452\n4855066538\n3258822247\n6367132985\n3417357693\n3866467130\n3911603439\n4544154517\n4025002576\n5972134999\n4407232603\n4521575211\n7471187064\n6849692574\n5051290405\n7125289377\n5317066117\n5417144022\n9076292981\n5512874033\n10124078300\n7780397458\n6595427117\n8928807814\n6676179940\n8721533668\n11256925177\n7170425686\n7283824823\n7442360269\n7778070569\n11805400034\n8432235179\n8546577787\n10034449244\n11691057426\n9572865616\n13197541480\n10368356522\n10468434427\n10734210139\n15981308460\n10930018055\n12108301150\n12683299719\n18708088624\n13271607057\n30399146050\n14118540209\n13846605626\n17204874930\n14454250509\n14726185092\n20481366303\n21624676195\n16210305748\n16978812966\n19362253234\n20836790949\n19941222138\n21298374577\n20041300043\n21102566661\n23639963579\n26801839928\n24201625112\n27118212683\n23038319205\n30825418592\n32554694250\n27390147266\n27725857566\n35207551395\n27965145835\n37312872409\n29180435601\n30664556257\n44742530240\n33189118714\n53853068827\n35572558982\n36341066200\n56870933559\n39982522181\n44140885866\n43681263622\n50705856300\n61735129851\n46678282784\n58245870600\n47239944317\n50156531888\n87822149488\n55355293101\n55116004832\n63853674971\n99061226366\n110531957755\n57145581436\n59844991858\n90359546406\n70647078438\n68761677696\n80481952066\n104385525753\n71913625182\n126002371539\n131187808366\n83663785803\n90819168650\n132615352667\n105511824989\n127160234850\n119208968072\n108402402488\n115200284959\n110471297933\n120999256407\n112261586268\n123698666829\n134500753409\n237000878420\n171301120716\n116990573294\n130492070296\n201481208473\n161466247088\n140675302878\n252187064773\n155577410985\n162732793832\n174482954453\n189175610792\n198864070762\n196330993639\n213914227477\n215983122922\n218873700421\n220663988756\n222732884201\n357058619458\n227461871227\n395195064401\n286744540721\n398762991943\n247482643590\n334033914548\n257665876172\n271167373174\n293224864128\n302141549966\n354589530355\n354441481747\n344753021777\n570424604669\n337215748285\n363658565245\n470031443936\n410245221116\n415204694060\n434578216233\n509477424922\n439537689177\n626224863170\n450194755428\n485127747399\n474944514817\n518650016764\n505148519762\n528833249346\n549624193556\n550890740300\n559807426138\n564392237302\n656883429373\n639357298251\n1131373382932\n904065675303\n1069540757064\n773903786361\n778863259305\n798236781478\n825449915176\n849782910293\n854742383237\n1629348183202\n984421939739\n889732444605\n955343275190\n925139270245\n1003777764163\n980093034579\n1023798536526\n1054772713318\n1078457442902\n1100514933856\n1110698166438\n1874154384344\n1296240727624\n1413261084612\n2396755661480\n1552767045666\n1572140567839\n1577100040783\n1933199826139\n1810085658427\n1715182359781\n1675232825469\n1704525293530\n1744474827842\n1814871714850\n1845075719795\n1869825479184\n1880482545435\n1928917034408\n2913292860718\n2034865747897\n3803071418752\n3585007838965\n2178972376758\n2974669318200\n2406938894062\n2709501812236\n2868381295463\n2966028130278\n3124907613505\n3252332866252\n3459657187623\n3714901198979\n3879941467692\n3379758118999\n3390415185250\n3419707653311\n3559346542692\n3963782782305\n3725558265230\n4585911270820\n3750308024619\n3809399579843\n5594212290589\n7773184667347\n4213838124655\n4888474188994\n5153641694958\n5047353672221\n5116440706298\n7115973450480\n6345786249277\n5993288908968\n6934307193348\n6504665732504\n6632090985251\n6799465772310\n8606700214913\n6810122838561\n6770173304249\n8903949719577\n11822781382342\n7284904807922\n7475866289849\n7559707604462\n8963041274801\n11523492691966\n12332258480143\n9102312313649\n9261191796876\n9330278830953\n10042115883952\n11040642581189\n15606978046153\n11109729615266\n12339075158245\n12497954641472\n18622247154652\n13136756717755\n13274839036753\n13431556757561\n16247946082723\n14095027646483\n13580296142810\n20991264362023\n14760771097771\n22891882854075\n14844612412384\n15035573894311\n22397948514631\n28341067240581\n24837029799717\n18363504110525\n28192327855332\n20370921412142\n19372394714905\n21082758465141\n30367749143924\n23448804773511\n23607684256738\n25475831876000\n25772793678225\n29130601540794\n28424908555194\n26706395794314\n27011852900371\n27675323789293\n28615870037121\n29605383510155\n29796344992082\n29880186306695\n33208116522909\n47988264752026\n35406495306453\n37735898825430\n38734425522667\n58980910201134\n39446262575666\n40455153180046\n39743316127047\n42821199488416\n57040778592315\n47056489030249\n88111511741928\n51283008046031\n51248625554225\n64022365343574\n80557098313846\n64442294619744\n53718248694685\n54687176689664\n56291193826414\n67616085132125\n63088302829604\n59676531298777\n68614611829362\n70944015348339\n77182161401096\n73142394131883\n134222939993411\n78180688098333\n79189578702713\n79901415755712\n96746347006460\n82564515615463\n89877688518665\n98305114584474\n103347682856663"
    )
  (day9part1 my-puzzle 25) ; 26796446
  )






